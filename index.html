<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compteur de Pompes IA - MediaPipe</title>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <script defer src="script.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>💪 Compteur de Pompes</h1>
            <p class="subtitle">Détection par Google MediaPipe Pose</p>
        </header>

        <div class="main-grid">
            <div class="card">
                <div class="error" id="error"></div>
                <div class="video-container">
                    <video id="video" autoplay playsinline muted></video>
                    <canvas id="canvas"></canvas>
                    <div class="skeleton-indicator" id="skeletonIndicator">🎯 CORPS DÉTECTÉ</div>
                    <div class="angle-display" id="angleDisplay">
                        Angle coude: <span id="angleValue">-</span>°
                    </div>
                </div>

                <div class="counter-big">
                    <div class="counter-number" id="counter">0</div>
                    <div class="counter-label">pompes cette session</div>
                    <div class="position-status neutral" id="positionStatus">En attente...</div>
                </div>

                <div class="controls">
                    <button class="btn btn-start" id="startBtn">▶ Démarrer</button>
                    <button class="btn btn-stop" id="stopBtn" style="display:none;">⏹ Terminer</button>
                    <button class="btn btn-reset" id="resetBtn">↻ Reset</button>
                </div>
            </div>

            <div class="stats-section">
                <div class="card">
                    <h2>📊 Statistiques</h2>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value" id="totalCount">0</div>
                            <div class="stat-label">Total pompes</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value green" id="sessionCount">0</div>
                            <div class="stat-label">Sessions</div>
                        </div>
                    </div>
                    <div class="record-box" id="recordBox" style="display:none;">
                        🏆 <strong>Record:</strong> <span id="recordValue">0</span> pompes
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>📅 Historique</h2>
                    <div class="history-list" id="historyList">
                        <div class="empty-state">Aucune session enregistrée</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card instructions">
            <h3>📋 Comment ça marche ?</h3>
            <ol>
                <li>Cliquez sur "Démarrer" et autorisez l'accès caméra</li>
                <li>Placez-vous de PROFIL devant la caméra</li>
                <li>MediaPipe détecte votre squelette en temps réel</li>
                <li>Faites vos pompes : angle coude 90° puis 160°</li>
            </ol>
            <div class="tip">
                💡 Positionnez-vous de profil pour une détection optimale
            </div>
        </div>
    </div>

</body>
</html>